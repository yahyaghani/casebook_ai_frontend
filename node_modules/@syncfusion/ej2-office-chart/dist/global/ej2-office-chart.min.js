/*!
*  filename: ej2-office-chart.min.js
*  version : 25.2.3
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.officechart=function(e,r,t,i){"use strict";r.Chart.Inject(r.AreaSeries,r.StackingAreaSeries,r.BarSeries,r.PieSeries,r.StackingBarSeries,r.PolarSeries,r.ScatterSeries,r.BubbleSeries,r.RadarSeries,r.DateTime,r.ColumnSeries,r.StackingColumnSeries,r.LineSeries,r.StackingLineSeries,r.ErrorBar,r.Trendlines,r.SplineSeries,r.DataLabel,r.Category,r.Legend,r.Tooltip,r.Export),r.AccumulationChart.Inject(r.AccumulationLegend,r.PieSeries,r.AccumulationTooltip,r.AccumulationDataLabel);var a=function(){function e(){this.keywordIndex=void 0,this.chartYValues=[]}return e.prototype.chartRender=function(e,t){this.keywordIndex=i.isNullOrUndefined(t)?0:t,this.chartType=e[u[this.keywordIndex]],this.isPieType="Pie"===this.chartType||"Doughnut"===this.chartType;var a=this.chartData(e,this.chartType),s={enableAnimation:!1,width:e[o[this.keywordIndex]]*(96/72)+"px",height:e[n[this.keywordIndex]]*(96/72)+"px"};this.isPieType?this.chart=new r.AccumulationChart(s):(this.chart=new r.Chart(s),this.chart.primaryXAxis=this.chartPrimaryXAxis(e[y[this.keywordIndex]],this.chartType),this.chart.primaryYAxis=this.chartPrimaryYAxis(e[p[this.keywordIndex]])),this.chart.series=this.chartSeries(e[h[this.keywordIndex]],a,this.chartType);for(var d=0;d<this.chart.series.length;d++)this.chart.series[parseInt(d.toString(),10)].animation.enable=!1;this.chart.title=e[l[this.keywordIndex]],this.chart.legendSettings=this.parseChartLegend(e[c[this.keywordIndex]])},e.prototype.convertChartToImage=function(e,r,t){var a=this;return new Promise(function(o,n){var s=0,d=0,h=a.getControlsValue([e],r,t);s=s||h.width,d=d||h.height;var c=i.createElement("canvas"),y=Math.max(1,window.devicePixelRatio||1);c.width=s*y,c.height=d*y,c.style.width=s+"px",c.style.height=d+"px";var p=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(h.svg)],{type:"image/svg+xml"})),l=new Image,u=c.getContext("2d");u.scale(y,y),l.onload=function(){u.drawImage(l,0,0),window.URL.revokeObjectURL(p);var e=c.toDataURL("image/png");o(e)},l.onerror=function(){n("Invalid data")},l.src=p})},e.prototype.getControlsValue=function(e,r,i){var a=0,o=0,n="",s=new t.SvgRenderer("").createSvg({id:"Image_Export",width:200,height:200});return e.map(function(e){if(e){var t=e.svgObject.cloneNode(!0),i=e.renderer.createGroup({style:"transform: translateY("+o+"px)"});i.appendChild(t),a=Math.max(e.availableSize.width,r),o+=e.availableSize.height,n+=e.svgObject.outerHTML,s.appendChild(i)}}),s.setAttribute("width",a+""),s.setAttribute("height",o+""),{width:a,height:o,svg:s}},e.prototype.officeChartType=function(e){var r="";switch(e){case"Area_Stacked":r="StackingArea";break;case"Area":r="Area";break;case"Area_Stacked_100":r="StackingArea100";break;case"Bar_Clustered":r="Bar";break;case"Bar_Stacked":r="StackingBar";break;case"Bar_Stacked_100":r="StackingBar100";break;case"Column_Clustered":r="Column";break;case"Column_Stacked":r="StackingColumn";break;case"Column_Stacked_100":r="StackingColumn100";break;case"Scatter_Markers":r="Scatter";break;case"Bubble":r="Bubble";break;case"Doughnut":case"Pie":r="Pie";break;case"Line_Stacked_100":case"Line_Markers_Stacked_100":r="StackingLine100";break;case"Line":case"Line_Markers":r="Line";break;case"Line_Stacked":case"Line_Markers_Stacked":r="StackingLine"}return r},e.prototype.chartSeries=function(e,r,t){for(var i=[],a=0;a<e.length;a++){var o=e[parseInt(a.toString(),10)],n=this.writeChartSeries(o,r,t,a);i.push(n)}return i},e.prototype.writeChartSeries=function(e,r,t,a){var o,n=this.officeChartType(t),s=e[w[this.keywordIndex]][parseInt(a.toString(),10)],d={};if(d.type=n,d.dataSource=r,d.name=e[x[this.keywordIndex]],d.xName="x",d.yName="y"+a,"Bubble"===t&&(d.size="size"+a),this.isPieType?(d.pointColorMapping="color","Doughnut"===t&&(d.innerRadius="75%",d.radius="70%")):(i.isNullOrUndefined(s)&&(s=e[w[this.keywordIndex]][0]),o=this.chartFormat(s,n),d.fill=o,i.isNullOrUndefined(s[g[this.keywordIndex]][P[this.keywordIndex]])||(d.pointColorMapping="color")),"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Markers_Stacked_100"!==t||(d.marker={visible:!0}),e.hasOwnProperty(m[this.keywordIndex]))if(this.isPieType)d.dataLabel=this.parseDataLabels(e[m[this.keywordIndex]]);else{var h={};h.dataLabel=this.parseDataLabels(e[m[this.keywordIndex]]),d.marker=h}if(e.hasOwnProperty(I[this.keywordIndex])){var c=e[I[this.keywordIndex]];d.errorBar=this.parseErrorBars(c)}if(e.hasOwnProperty(k[this.keywordIndex]))for(var y=e[k[this.keywordIndex]],p=[],l=0;l<y.length;l++){var u=y[parseInt(l.toString(),10)],f={};f=this.parseTrendLines(u,o),p.push(f),d.trendlines=p}return d},e.prototype.parseDataLabels=function(e){var r={};return r.visible=!0,this.isPieType?"BestFit"===e[v[this.keywordIndex]]||"Inside"===e[v[this.keywordIndex]]?r.position="Inside":r.position="Outside":r.position=this.dataLabelPosition(e[v[this.keywordIndex]]),r},e.prototype.parseErrorBars=function(e){var r={};return r.visible=!0,r.type=e[L[this.keywordIndex]],r.direction=e[A[this.keywordIndex]],"Cap"===e[T[this.keywordIndex]]?r.errorBarCap={width:1}:r.errorBarCap={width:0},r},e.prototype.parseTrendLines=function(e,r){var t={};return t.type=e[L[this.keywordIndex]],t.name=e[C[this.keywordIndex]],t.forwardForecast=e[B[this.keywordIndex]],t.backwardForecast=e[_[this.keywordIndex]],"NaN"===e[M[this.keywordIndex]]?t.intercept=0:t.intercept=e[M[this.keywordIndex]],t.fill=r,t},e.prototype.dataLabelPosition=function(e){var r="Auto";switch(e){case"Outside":r="Outer";break;case"Center":r="Middle";break;case"Inside":r="Top";break;case"OutsideBase":r="Bottom"}return r},e.prototype.chartFormat=function(e,r){var t=e;return"Line"===r||"StackingLine"===r||"StackingLine100"===r?t[f[this.keywordIndex]][S[this.keywordIndex]]:t[g[this.keywordIndex]][S[this.keywordIndex]]},e.prototype.chartPrimaryXAxis=function(e,r){var t={};e[l[this.keywordIndex]]&&(t.title=e[l[this.keywordIndex]]);var i=this.chartCategoryType(e[j[this.keywordIndex]]);return t.valueType=i,"DateTime"===i&&(t.intervalType="Days",t.labelFormat="M/d/yyyy",t.edgeLabelPlacement="Shift"),"Scatter_Markers"!==r&&"Bubble"!==r||this.checkAndSetAxisValue(t,e),this.parseBoolValue(e[N[this.keywordIndex]])&&(t.majorGridLines={width:1}),this.parseBoolValue(e[V[this.keywordIndex]])&&(t.minorTicksPerInterval=4),t},e.prototype.chartCategoryType=function(e){var r="";switch(e){case"Time":r="DateTime";break;case"Automatic":r="Category"}return r},e.prototype.chartPrimaryYAxis=function(e){var r={};return e[l[this.keywordIndex]]&&(r.title=e[l[this.keywordIndex]]),this.checkAndSetAxisValue(r,e),e[N[this.keywordIndex]]&&(r.majorGridLines={width:1}),e[V[this.keywordIndex]]&&(r.minorTicksPerInterval=4),r},e.prototype.checkAndSetAxisValue=function(e,r){if(0!==r[F[this.keywordIndex]]&&(e.minimum=r[F[this.keywordIndex]]),0!==r[O[this.keywordIndex]]&&(e.maximum=r[O[this.keywordIndex]]),0!==r[D[this.keywordIndex]]){var t=r[U[this.keywordIndex]];t&&this.parseBoolValue(t)?e.interval=this.calculateMajorUnit(this.chartYValues):e.interval=r[D[this.keywordIndex]]}},e.prototype.calculateMajorUnit=function(e){if(e&&e.length>0){for(var r=Number.MIN_VALUE,t=Number.MAX_VALUE,i=0;i<e.length;i++){var a=e[parseInt(i.toString(),10)];a>r&&(r=a),a<t&&(t=a)}var o=(r-t)/1.5;return this.roundToNiceNumber(o)}return 1},e.prototype.roundToNiceNumber=function(e){var r=Math.floor(Math.log(e)/Math.log(10)),t=Math.pow(10,r),i=e/t;return i<1.5?1*t:i<3?2*t:i<7?5*t:10*t},e.prototype.chartData=function(e,r){for(var t=e[d[this.keywordIndex]],i=[],a=0;a<t.length;a++){var o=t[parseInt(a.toString(),10)],n=this.chartPlotData(o,e,r,a);i.push(n)}return i},e.prototype.chartPlotData=function(e,r,t,a){var o=this,n={},d=r[h[this.keywordIndex]];if("m/d/yyyy"===r[y[this.keywordIndex]][R[this.keywordIndex]]){var c=e[z[this.keywordIndex]].split("/"),p=Number(c[0]),l=Number(c[1]),k=Number(c[2]);n.x=new Date(k,p-1,l)}else n.x=e[z[this.keywordIndex]];for(var x=0;x<d.length;x++){var m=e[s[this.keywordIndex]][parseInt(x.toString(),10)],I=m[Y[this.keywordIndex]];if(this.chartYValues.push(I),n["y"+x]=I,"Bubble"===t&&(n["size"+x]=m[E[this.keywordIndex]]),"Pie"===r[u[this.keywordIndex]]||"Doughnut"===r[u[this.keywordIndex]]||"Column_Stacked"===r[u[this.keywordIndex]]){var f=d[parseInt(x.toString(),10)],P=f[w[this.keywordIndex]].find(function(e){return e[b[o.keywordIndex]]===a});i.isNullOrUndefined(P)?f[w[this.keywordIndex]].length>1&&0===f[w[this.keywordIndex]][parseInt(a.toString(),10)][b[this.keywordIndex]]?(P=f[w[this.keywordIndex]][parseInt(a.toString(),10)],n.color=this.chartFormat(P,t)):i.isNullOrUndefined(f[G[this.keywordIndex]])||i.isNullOrUndefined(f[G[this.keywordIndex]][g[this.keywordIndex]])||f[G[this.keywordIndex]][g[this.keywordIndex]][S[this.keywordIndex]].length>7&&(n.color=this.getColor(f[G[this.keywordIndex]][g[this.keywordIndex]][S[this.keywordIndex]])):n.color=this.chartFormat(P,t)}}return n},e.prototype.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.prototype.parseChartLegend=function(e){var r={},t=e[v[this.keywordIndex]];return"Corner"===t&&(t="right"),t?(r.visible=!0,r.position=t.charAt(0).toUpperCase()+t.slice(1)):r.visible=!1,r},e.prototype.parseBoolValue=function(e){return e instanceof String?!i.isNullOrUndefined(e)&&"f"!=e&&"0"!=e&&"off"!=e&&"false"!=e:1==e},e.prototype.destroy=function(){this.chart&&this.chart.destroy(),this.chart=void 0,this.chartYValues&&(this.chartYValues=[]),this.chartYValues=void 0},e}(),o=["width","w"],n=["height","h"],s=["chartData","chd"],d=["chartCategory","c"],h=["chartSeries","cs"],c=["chartLegend","cl"],y=["chartPrimaryCategoryAxis","cpca"],p=["chartPrimaryValueAxis","cpva"],l=["chartTitle","ctt"],u=["chartType","ct"],k=["trendLines","tl"],w=["dataPoints","dp"],x=["seriesName","sn"],m=["dataLabel","sl"],I=["errorBar","eb"],g=["fill","f"],f=["line","l"],S=["rgb","rgb"],b=["id","i"],P=["foreColor","fc"],v=["position","p"],L=["type","t"],C=["name","n"],A=["direction","dir"],T=["endStyle","est"],B=["forward","fw"],_=["backward","bw"],M=["intercept","itr"],j=["categoryType","ct"],N=["hasMajorGridLines","hmajgl"],V=["hasMinorGridLines","hmingl"],D=["majorUnit","maju"],U=["isAutoMajor","iam"],O=["maximumValue","maxv"],F=["minimumValue","minv"],z=["categoryXName","cx"],R=["numberFormat","nf"],Y=["yValue","y"],E=["size","sz"],G=["seriesFormat","sf"];return e.ChartComponent=a,e.widthProperty=o,e.heightProperty=n,e.chartDataProperty=s,e.chartCategoryProperty=d,e.chartSeriesProperty=h,e.chartLegendProperty=c,e.chartPrimaryCategoryAxisProperty=y,e.chartPrimaryValueAxisProperty=p,e.chartTitleProperty=l,e.chartTypeProperty=u,e.trendLinesProperty=k,e.dataPointsProperty=w,e.seriesNameProperty=x,e.dataLabelProperty=m,e.errorBarProperty=I,e.fillProperty=g,e.lineProperty=f,e.rgbProperty=S,e.idProperty=b,e.foreColorProperty=P,e.positionProperty=v,e.typeProperty=L,e.nameProperty=C,e.directionProperty=A,e.endStyleProperty=T,e.forwardProperty=B,e.backwardProperty=_,e.interceptProperty=M,e.categoryTypeProperty=j,e.hasMajorGridLinesProperty=N,e.hasMinorGridLinesProperty=V,e.majorUnitProperty=D,e.isAutoMajorProperty=U,e.maximumValueProperty=O,e.minimumValueProperty=F,e.categoryXNameProperty=z,e.numberFormatProperty=R,e.yValueProperty=Y,e.sizeProperty=E,e.seriesFormatProperty=G,e}({},ej.charts,ej.svgbase,ej.base),this.ejs=ej;
//# sourceMappingURL=ej2-office-chart.min.js.map
