{"ast":null,"code":"var _jsxFileName = \"/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/Dashboard/OpenFileModal.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { PdfLoader, PdfHighlighter, Highlight, Popup, AreaHighlight } from \"react-pdf-highlighter\";\nimport { BASE_URL_DEV } from \"../utils\";\nimport Spinner from \"../shared/Spinner\";\nimport processMd from \"./markdown\";\n\nconst updateHash = highlight => {\n  document.location.hash = `file-highlight-${highlight.id}`;\n};\n\nconst parseIdFromHash = () => document.location.hash.slice(\"#file-highlight-\".length);\n\nconst resetHash = () => {\n  document.location.hash = \"\";\n};\n\nconst HighlightPopup = ({\n  comment\n}) => comment.text ? /*#__PURE__*/React.createElement(\"div\", {\n  className: \"Highlight__popup\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 3\n  }\n}, comment.emoji, \" \", processMd(comment.text)) : null;\n\nfunction OpenFileModal({\n  showFileModal,\n  setShowFileModal,\n  filePost\n}) {\n  const handleClose = () => {\n    setShowFileModal(false);\n  };\n\n  const pdfHighlighter = useRef(null);\n  const {\n    fileUrl,\n    fileName\n  } = filePost;\n  const [highlights, setHighlights] = useState([]);\n  const url = `${BASE_URL_DEV}/${fileUrl}`;\n\n  const fetchHighlights = async () => {\n    const result = await axios(`${BASE_URL_DEV}/highlights-json/${filePost.user_info && filePost.user_info.public_id}/${fileName}`);\n    const fileHighlights = result.data;\n    console.log(\"fileHighlights: \");\n    console.log(fileHighlights);\n\n    if (fileHighlights && fileHighlights.highlights) {\n      console.log(fileHighlights.highlights);\n      setHighlights(fileHighlights.highlights && fileHighlights.highlights.highlights);\n    }\n  };\n\n  useEffect(() => {\n    fetchHighlights();\n  }, []);\n\n  const getHighlightById = id => highlights.find(highlight => highlight.id === id);\n\n  const scrollToHighlightFromHash = () => {\n    const highlight = getHighlightById(parseIdFromHash());\n    console.log(highlight);\n\n    if (highlight && pdfHighlighter.current) {\n      console.log(pdfHighlighter);\n      pdfHighlighter.current.scrollTo(highlight);\n    }\n  };\n\n  useEffect(() => {\n    window.addEventListener(\"hashchange\", scrollToHighlightFromHash, false);\n    return () => window.removeEventListener(\"hashchange\", scrollToHighlightFromHash);\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Modal, {\n    show: showFileModal || false,\n    onHide: handleClose,\n    size: \"xl\",\n    style: {\n      width: \"85vw\",\n      height: \"1250px\",\n      margin: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      color: \"#000000\",\n      zIndex: \"100\",\n      overflow: \"hidden\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebarnew\",\n    style: {\n      width: \"25%\",\n      minWidth: \"20%\",\n      height: \"calc(100vh - 70px)\",\n      overflowY: \"scroll\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"description\",\n    style: {\n      padding: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, \"CASEVIEWER\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"small\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 10\n    }\n  }, \"To create area highlight hold \\u2325 Option key (Alt), then click and drag.\"))), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"sidebar__highlights\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 8\n    }\n  }, highlights.length > 0 ? highlights.map((highlight, index) => /*#__PURE__*/React.createElement(\"li\", {\n    key: index,\n    className: \"sidebar__highlight\",\n    onClick: () => {\n      updateHash(highlight);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }, processMd(highlight.comment.text)), highlight.content.text ? /*#__PURE__*/React.createElement(\"blockquote\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 14\n    }\n  }, `${highlight.content.text.slice(0, 90).trim()}…`) : null, highlight.content.image ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"highlight__image\",\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 14\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: highlight.content.image,\n    alt: \"Screenshot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 15\n    }\n  })) : null), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"highlight__location\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 12\n    }\n  }, \"Page \", highlight.position.pageNumber))) : /*#__PURE__*/React.createElement(\"li\", {\n    className: \"sidebar__highlight\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"p-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      margin: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 12\n    }\n  }, \"No Highlights Available for this Pdf!\"))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-75\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }\n  }, url && /*#__PURE__*/React.createElement(PdfLoader, {\n    className: \"my-pdf-viewer\",\n    url: url,\n    beforeLoad: /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 22\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }, pdfDocument => /*#__PURE__*/React.createElement(PdfHighlighter, {\n    ref: pdfHighlighter,\n    pdfDocument: pdfDocument,\n    enableAreaSelection: event => event.altKey,\n    onScrollChange: resetHash,\n    scrollRef: scrollTo => {},\n    highlightTransform: (highlight, index, setTip, hideTip, viewportToScaled, screenshot, isScrolledTo) => {\n      const isTextHighlight = !Boolean(highlight.content && highlight.content.image);\n      const component = isTextHighlight ? /*#__PURE__*/React.createElement(Highlight, {\n        isScrolledTo: isScrolledTo,\n        position: highlight.position,\n        comment: highlight.comment,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 14\n        }\n      }) : /*#__PURE__*/React.createElement(AreaHighlight, {\n        highlight: highlight,\n        onChange: boundingRect => {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 14\n        }\n      });\n      return /*#__PURE__*/React.createElement(Popup, {\n        popupContent: /*#__PURE__*/React.createElement(HighlightPopup, Object.assign({}, highlight, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 29\n          }\n        })),\n        onMouseOver: popupContent => setTip(highlight, highlight => popupContent),\n        onMouseOut: hideTip,\n        key: index,\n        children: component,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 14\n        }\n      });\n    },\n    highlights: highlights,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 11\n    }\n  })))))));\n}\n\nexport default OpenFileModal;","map":{"version":3,"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/Dashboard/OpenFileModal.js"],"names":["React","useState","useEffect","useRef","Modal","axios","PdfLoader","PdfHighlighter","Highlight","Popup","AreaHighlight","BASE_URL_DEV","Spinner","processMd","updateHash","highlight","document","location","hash","id","parseIdFromHash","slice","length","resetHash","HighlightPopup","comment","text","emoji","OpenFileModal","showFileModal","setShowFileModal","filePost","handleClose","pdfHighlighter","fileUrl","fileName","highlights","setHighlights","url","fetchHighlights","result","user_info","public_id","fileHighlights","data","console","log","getHighlightById","find","scrollToHighlightFromHash","current","scrollTo","window","addEventListener","removeEventListener","width","height","margin","color","zIndex","overflow","minWidth","overflowY","padding","marginBottom","map","index","content","marginTop","trim","image","position","pageNumber","pdfDocument","event","altKey","setTip","hideTip","viewportToScaled","screenshot","isScrolledTo","isTextHighlight","Boolean","component","boundingRect","popupContent"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport {\n\tPdfLoader,\n\tPdfHighlighter,\n\tHighlight,\n\tPopup,\n\tAreaHighlight,\n} from \"react-pdf-highlighter\";\nimport { BASE_URL_DEV } from \"../utils\";\n\nimport Spinner from \"../shared/Spinner\";\nimport processMd from \"./markdown\";\n\nconst updateHash = (highlight) => {\n\tdocument.location.hash = `file-highlight-${highlight.id}`;\n};\nconst parseIdFromHash = () =>\n\tdocument.location.hash.slice(\"#file-highlight-\".length);\n\nconst resetHash = () => {\n\tdocument.location.hash = \"\";\n};\n\nconst HighlightPopup = ({ comment }) =>\n\tcomment.text ? (\n\t\t<div className=\"Highlight__popup\">\n\t\t\t{comment.emoji} {processMd(comment.text)}\n\t\t</div>\n\t) : null;\n\nfunction OpenFileModal({ showFileModal, setShowFileModal, filePost }) {\n\tconst handleClose = () => {\n\t\tsetShowFileModal(false);\n\t};\n\n\tconst pdfHighlighter = useRef(null);\n\n\tconst { fileUrl, fileName } = filePost;\n\n\tconst [highlights, setHighlights] = useState([]);\n\n\tconst url = `${BASE_URL_DEV}/${fileUrl}`;\n\n\tconst fetchHighlights = async () => {\n\t\tconst result = await axios(\n\t\t\t`${BASE_URL_DEV}/highlights-json/${filePost.user_info && filePost.user_info.public_id\n\t\t\t}/${fileName}`\n\t\t);\n\t\tconst fileHighlights = result.data;\n\t\tconsole.log(\"fileHighlights: \");\n\t\tconsole.log(fileHighlights);\n\t\tif (fileHighlights && fileHighlights.highlights) {\n\t\t\tconsole.log(fileHighlights.highlights);\n\t\t\tsetHighlights(\n\t\t\t\tfileHighlights.highlights && fileHighlights.highlights.highlights\n\t\t\t);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tfetchHighlights();\n\t}, []);\n\n\tconst getHighlightById = (id) =>\n\t\thighlights.find((highlight) => highlight.id === id);\n\tconst scrollToHighlightFromHash = () => {\n\t\tconst highlight = getHighlightById(parseIdFromHash());\n\t\tconsole.log(highlight);\n\t\tif (highlight && pdfHighlighter.current) {\n\t\t\tconsole.log(pdfHighlighter);\n\t\t\tpdfHighlighter.current.scrollTo(highlight);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\twindow.addEventListener(\"hashchange\", scrollToHighlightFromHash, false);\n\n\t\treturn () =>\n\t\t\twindow.removeEventListener(\"hashchange\", scrollToHighlightFromHash);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<Modal\n\t\t\t\tshow={showFileModal || false}\n\t\t\t\tonHide={handleClose}\n\t\t\t\tsize=\"xl\"\n\t\t\t\tstyle={{\n\t\t\t\t\twidth: \"85vw\", height: \"1250px\",\n\t\t\t\t\tmargin: 'auto'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Modal.Body\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: \"#000000\",\n\t\t\t\t\t\tzIndex: \"100\",\n\t\t\t\t\t\toverflow: \"hidden\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"d-flex w-100\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"sidebarnew\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: \"25%\",\n\t\t\t\t\t\t\t\tminWidth: \"20%\",\n\t\t\t\t\t\t\t\theight: \"calc(100vh - 70px)\",\n\t\t\t\t\t\t\t\toverflowY: \"scroll\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"description\" style={{ padding: \"1rem\" }}>\n\t\t\t\t\t\t\t\t<h2 style={{ marginBottom: \"1rem\" }}>CASEVIEWER</h2>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\tTo create area highlight hold ⌥ Option key (Alt), then click\n\t\t\t\t\t\t\t\t\t\tand drag.\n\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<ul className=\"sidebar__highlights\">\n\t\t\t\t\t\t\t\t{highlights.length > 0 ? (\n\t\t\t\t\t\t\t\t\thighlights.map((highlight, index) => (\n\t\t\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"sidebar__highlight\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tupdateHash(highlight);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<strong>{processMd(highlight.comment.text)}</strong>\n\t\t\t\t\t\t\t\t\t\t\t\t{highlight.content.text ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<blockquote style={{ marginTop: \"0.5rem\" }}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{`${highlight.content.text.slice(0, 90).trim()}…`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</blockquote>\n\t\t\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t\t\t{highlight.content.image ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"highlight__image\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ marginTop: \"0.5rem\" }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={highlight.content.image}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={\"Screenshot\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"highlight__location\">\n\t\t\t\t\t\t\t\t\t\t\t\tPage {highlight.position.pageNumber}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<li className=\"sidebar__highlight\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"p-2\">\n\t\t\t\t\t\t\t\t\t\t\t<p style={{ margin: 0 }}>\n\t\t\t\t\t\t\t\t\t\t\t\tNo Highlights Available for this Pdf!\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"w-75\">\n\t\t\t\t\t\t\t{url && (\n\t\t\t\t\t\t\t\t<PdfLoader\n\t\t\t\t\t\t\t\t\tclassName=\"my-pdf-viewer\"\n\t\t\t\t\t\t\t\t\turl={url}\n\t\t\t\t\t\t\t\t\tbeforeLoad={<Spinner />}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{(pdfDocument) => (\n\t\t\t\t\t\t\t\t\t\t<PdfHighlighter\n\t\t\t\t\t\t\t\t\t\t\tref={pdfHighlighter}\n\t\t\t\t\t\t\t\t\t\t\tpdfDocument={pdfDocument}\n\t\t\t\t\t\t\t\t\t\t\tenableAreaSelection={(event) => event.altKey}\n\t\t\t\t\t\t\t\t\t\t\tonScrollChange={resetHash}\n\t\t\t\t\t\t\t\t\t\t\tscrollRef={(scrollTo) => { }}\n\t\t\t\t\t\t\t\t\t\t\thighlightTransform={(\n\t\t\t\t\t\t\t\t\t\t\t\thighlight,\n\t\t\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\t\t\tsetTip,\n\t\t\t\t\t\t\t\t\t\t\t\thideTip,\n\t\t\t\t\t\t\t\t\t\t\t\tviewportToScaled,\n\t\t\t\t\t\t\t\t\t\t\t\tscreenshot,\n\t\t\t\t\t\t\t\t\t\t\t\tisScrolledTo\n\t\t\t\t\t\t\t\t\t\t\t) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst isTextHighlight = !Boolean(\n\t\t\t\t\t\t\t\t\t\t\t\t\thighlight.content && highlight.content.image\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst component = isTextHighlight ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Highlight\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisScrolledTo={isScrolledTo}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tposition={highlight.position}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomment={highlight.comment}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<AreaHighlight\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thighlight={highlight}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(boundingRect) => { }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Popup\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpopupContent={<HighlightPopup {...highlight} />}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonMouseOver={(popupContent) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTip(highlight, (highlight) => popupContent)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonMouseOut={hideTip}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren={component}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\thighlights={highlights}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</PdfLoader>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Modal.Body>\n\t\t\t</Modal>\n\t\t</>\n\t);\n}\n\nexport default OpenFileModal;\n"]},"metadata":{},"sourceType":"module"}